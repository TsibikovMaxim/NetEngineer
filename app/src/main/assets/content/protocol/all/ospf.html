<!DOCTYPE html>
<html>
<head>
	<!-- Charset -->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>OSPF</title>
	<!-- Include meta tag to ensure proper rendering and touch zooming-->
	<meta name="view-port" content="width=device-width, initial-scale=1">
	<!-- Include jQuery Mobile stylesheets -->
	<link rel="stylesheet" href="../../../css/jquery.mobile-1.4.5.min.css" />
	<link rel="stylesheet" href="../../../css/themes/my-theme.css" />
	<link rel="stylesheet" href="../../../css/themes/jquery.mobile.icons.min.css" />
	<link rel="stylesheet" href="../../../css/my-style.css" />
	<!-- Include the jQuery Mobile library -->
	<script type="text/javascript" src="../../../js/jquery-1.11.3.min.js"></script>
	<!-- Include the jQuery Mobile library -->
	<script type="text/javascript" src="../../../js/jquery.mobile-1.4.5.min.js"></script>
	<!-- AdMob-->
	<script type="text/javascript" src="../../../js/admob.js"></script>
	<!-- cordova js -->
	<script src="../../../cordova.js"></script>
</head>
<body>

<div data-role="page" id="position" data-theme="a">

	<div data-role="header" data-position="fixed">
		<a data-role="button" data-rel="back" data-ajax="false" class="ui-nodisc-icon transparentButton" data-icon="carat-l" data-iconpos="notext" data-theme="a">Кнопка назад</a>
		<h1>Описание</h1>
		<a href="../../../index.html" data-ajax="false" class="ui-nodisc-icon transparentButton" data-role="button" data-icon="home" data-iconpos="notext" data-shadow="false" data-transition="none" data-theme="a">На главную</a>
	</div>

	<div data-role="main" class="ui-content">

		<h3>OSPF</h3>

		<p><strong>OSPF</strong> (англ. Open Shortest Path First) — протокол динамической маршрутизации, основанный на технологии отслеживания состояния канала (link-state technology) и использующий для нахождения кратчайшего пути алгоритм Дейкстры.</p>

		<p>Протокол OSPF был разработан IETF в 1988 году. Последняя версия протокола представлена в RFC 2328 (1998 год). Протокол OSPF представляет собой протокол внутреннего шлюза (Interior Gateway Protocol — IGP). Протокол OSPF распространяет информацию о доступных маршрутах между маршрутизаторами одной автономной системы.</p>

		<p>OSPF имеет следующие преимущества:</p>

		<ul>
			<li>Высокая скорость сходимости по сравнению с дистанционно-векторными протоколами маршрутизации;</li>
			<li>Поддержка сетевых масок переменной длины (VLSM);</li>
			<li>Оптимальное использование пропускной способности с построением дерева кратчайших путей.</li>
		</ul>

		<hr><h3>Терминология протокола OSPF</h3>

		<ul>
			<li>Интерфейс (interface) — соединение маршрутизатора и одной из подключенных к нему сетей. При обсуждении OSPF термины интерфейс и канал (link) часто употребляются как синонимы.</li>
			<li>Объявление о состоянии канала (link-state advertisement, LSA) — объявление описывает все каналы маршрутизатора, все интерфейсы и состояние каналов.</li>
			<li>Состояние канала (link state) — состояние канала между двумя маршрутизаторами; обновления происходят при помощи пакетов LSA.</li>
			<li>Метрика (metric) — условный показатель «стоимости» пересылки данных по каналу.</li>
			<li>Автономная система (autonomous system) — это совокупность сетей под единым административным управлением, обеспечивающим общую для всех входящих в автономную систему маршрутизаторов политику маршрутизации. Обычно автономной системой управляет один поставщик услуг Интернет. Автономная система использует внутренние шлюзовые протоколы IGP (RIP, OSPF и IS-IS).</li>
			<li>Зона (area) — совокупность сетей и маршрутизаторов, имеющих один и тот же идентификатор зоны.</li>
			<li>Соседи (neighbours) — маршрутизаторы, имеющие интерфейсы в общей сети (зоне).</li>
			<li>Состояние смежности (adjacency) — взаимосвязь между определёнными соседними маршрутизаторами, установленная с целью обмена информацией маршрутизации.</li>
			<li>Hello-протокол (hello protocol) — используется для поддержания соседских отношений.</li>
			<li>База данных соседей (neighbours database) — список всех соседей.</li>
			<li>База данных состояния каналов (link state database, LSDB) — список всех записей о состоянии каналов. Встречается также термин топологическая база данных (topological database), употребляется как синоним базы данных состояния каналов.</li>
			<li>Идентификатор маршрутизатора (router ID, RID) — уникальное 32-битовое число, которое уникально идентифицирует маршрутизатор в пределах одной автономной системы.</li>
		</ul>

		<hr><h3>Описание работы протокола</h3>

		<ol>
			<li>Маршрутизаторы обмениваются hello-пакетами через все интерфейсы, на которых активирован OSPF. Маршрутизаторы, разделяющие общий канал передачи данных, становятся соседями, когда они приходят к договоренности об определённых параметрах, указанных в их hello-пакетах.</li>
			<li>На следующем этапе работы протокола маршрутизаторы будут пытаться перейти в состояние смежности со своими соседями. Переход в состояние смежности определяется типом маршрутизаторов, обменивающихся hello-пакетами, и типом сети, по которой передаются hello-пакеты. OSPF определяет несколько типов сетей и несколько типов маршрутизаторов. Пара маршрутизаторов, находящихся в состоянии смежности, синхронизирует между собой базу данных состояния каналов.</li>
			<li>Каждый маршрутизатор посылает объявления о состоянии канала маршрутизаторам, с которыми он находится в состоянии смежности.</li>
			<li>Каждый маршрутизатор, получивший объявление от смежного маршрутизатора, записывает передаваемую в нём информацию в базу данных состояния каналов маршрутизатора и рассылает копию объявления всем другим смежным с ним маршрутизаторам.</li>
			<li>Рассылая объявления внутри одной OSPF-зоны, все маршрутизаторы строят идентичную базу данных состояния каналов маршрутизатора.</li>
			<li>Когда база данных построена, каждый маршрутизатор использует алгоритм «кратчайший путь первым» для вычисления графа без петель, который будет описывать кратчайший путь к каждому известному пункту назначения с собой в качестве корня. Этот граф — дерево кратчайших путей.</li>
			<li>Каждый маршрутизатор строит таблицу маршрутизации из своего дерева кратчайших путей.</li>
		</ol>

		<hr><h3>Типы сетей, поддерживаемые протоколом OSPF</h3>

		<ul>
			<li>Широковещательные сети со множественным доступом (Ethernet, Token Ring)</li>
			<li>Точка-точка (T1, E1, коммутируемый доступ)</li>
			<li>Нешироковещательные сети со множественным доступом (NBMA) (Frame relay)</li>
		</ul>

		<hr><h3>Выделенный маршрутизатор (DR) и резервный выделенный маршрутизатор (BDR)</h3>

		<p>В сетях со множественным доступом отношения соседства устанавливаются между всеми маршрутизаторами. Если бы все маршрутизаторы в состоянии соседства обменивались топологической информацией, это привело бы к рассылке большого количество копий LSA. Если, к примеру, количество маршрутизаторов в сети со множественным доступом равно n, то будет установлено n(n-1)/2 отношений соседства. Каждый маршрутизатор будет рассылать n-1 LSA своим соседям, плюс одно LSA для сети, в результате сеть сгенерирует n² LSA.</p>

		<p>Для предотвращения проблемы рассылки копий LSA в сетях со множественным доступом выбираются выделенный маршрутизатор (DR) и запасной выделенный маршрутизатор (BDR).</p>

		<p><strong>Выделенный маршрутизатор</strong> (designated router, DR) — управляет процессом рассылки LSA в сети. Каждый маршрутизатор сети устанавливает отношения смежности с DR. Информация об изменениях в сети отправляется маршрутизатором, обнаружившим это изменение, на выделенный маршрутизатор, а тот, в свою очередь, отвечает за то, чтобы эта информация была отправлена остальным маршрутизаторам сегмента множественного доступа.</p>

		<p>Недостатком в схеме работы с DR маршрутизатором является то, что при выходе его из строя должен быть выбран новый DR. Новые отношения соседства должны быть сформированы и, пока базы данных маршрутизаторов не синхронизируются с базой данных нового DR, сеть будет недоступна для пересылки пакетов. Для устранения этого недостатка выбирается BDR.</p>

		<p><strong>Резервный выделенный маршрутизатор</strong> (backup designated router, BDR). Каждый маршрутизатор сети устанавливает отношения соседства не только с DR, но и BDR. DR и BDR также устанавливают отношения соседства и между собой. При выходе из строя DR, BDR становится DR и выполняет все его функции. Так как маршрутизаторы сети установили отношения соседства с BDR, время недоступности сети минимизируется.</p>

		<p>Маршрутизатор, выбранный DR или BDR в одной присоединённой к нему сети множественного доступа, может не быть DR (BDR) в другой присоединённой сети множественного доступа. Роль DR (BDR) является свойством интерфейса, а не свойством всего маршрутизатора. Иными словами, в каждом сегменте множественного доступа (например, коммутационном сегменте Ethernet), в котором общаются два или более OSPF-маршрутизатора, процесс выбора и распределение ролей DR/BDR происходит независимо от других сегментов множественного доступа.</p>

		<hr><h3>Таймеры протокола</h3>

		<ul>
			<li>HelloInterval — Интервал времени в секундах по истечении которого маршрутизатор отправляет следующий hello-пакет с интерфейса. Для широковещательных сетей и сетей точка-точка значение по умолчанию, как правило, 10 секунд. Для нешироковещательных сетей со множественным доступом значение по умолчанию 30 секунд.</li>
			<li>RouterDeadInterval — Интервал времени в секундах по истечении которого сосед будет считаться «мертвым». Этот интервал должен быть кратным значению HelloInterval. Как правило, RouterDeadInterval равен 4 интервалам отправки hello-пакетов, то есть 40 секунд.</li>
			<li>Wait Timer — Интервал времени в секундах по истечении которого маршрутизатор выберет DR в сети. Его значение равно значению интервала RouterDeadInterval.</li>
			<li>RxmtInterval — Интервал времени в секундах по истечении которого маршрутизатор повторно отправит пакет на который не получил подтверждения о получении (например, Database Description пакет или Link State Request пакеты). Этот интервал называется также Retransmit interval. Значение интервала 5 секунд.</li>
		</ul>

		<hr><h3>Типы маршрутизаторов</h3>

		<p><strong>Внутренний маршрутизатор</strong> (internal router) — маршрутизатор, все интерфейсы которого принадлежат одной зоне. У таких маршрутизаторов только одна база данных состояния каналов.</p>

		<p><strong>Пограничный маршрутизатор</strong> (area border router, ABR) — соединяет одну или больше зон с магистральной зоной и выполняет функции шлюза для межзонального трафика. У пограничного маршрутизатора всегда хотя бы один интерфейс принадлежит магистральной зоне. Для каждой присоединенной зоны маршрутизатор поддерживает отдельную базу данных состояния каналов.</p>

		<p><strong>Магистральный маршрутизатор</strong> (backbone router) — маршрутизатор у которого всегда хотя бы один интерфейс принадлежит магистральной зоне. Определение похоже на пограничный маршрутизатор, однако магистральный маршрутизатор не всегда является пограничным. Внутренний маршрутизатор, интерфейсы которого принадлежат нулевой зоне, также является магистральным.</p>

		<p><strong>Пограничный маршрутизатор</strong> автономной системы (AS boundary router, ASBR) — это маршрутизатор, один из портов которого находится в домене OSPF протокола, а другой в домене любого из внутренних шлюзовых протоколов (например RIP или EIGRP). Пограничный маршрутизатор автономной системы может находиться в любом месте автономной системы и быть пограничным или магистральным маршрутизатором.</p>

		<hr><h3>Типы объявлений о состоянии канала (LSA)</h3>

		<p><strong>Type 1 LSA — Router LSA</strong> — объявление о состоянии каналов маршрутизатора. Эти LSA распространяются всеми маршрутизаторами. В LSA содержится описание всех каналов маршрутизатора и стоимость (cost) каждого канала. Распространяются только в пределах одной зоны.</p>

		<p><strong>Type 2 LSA — Network LSA</strong> — объявление о состоянии каналов сети. Распространяется DR в сетях со множественным доступом. В LSA содержится описание всех маршрутизаторов присоединенных к сети, включая DR. Распространяются только в пределах одной зоны.</p>

		<p><strong>Type 3 LSA — Network Summary LSA</strong> — суммарное объявление о состоянии каналов сети. Объявление распространяется пограничными маршрутизаторами. Объявление описывает только маршруты к сетям вне зоны и не описывает маршруты внутри автономной системы. Пограничный маршрутизатор отправляет отдельное объявление для каждой известной ему сети.</p>

		<p>Когда маршрутизатор получает Network Summary LSA от пограничного маршрутизатора он не запускает алгоритм вычисления кратчайшего пути. Маршрутизатор просто добавляет к стоимости маршрута указанного в LSA стоимость маршрута к пограничному маршрутизатору. Затем маршрут к сети через пограничный маршрутизатор помещается в таблицу маршрутизации.</p>

		<p><strong>Type 4 LSA — ASBR Summary LSA</strong> — суммарное объявление о состоянии каналов пограничного маршрутизатора автономной системы. Объявление распространяется пограничными маршрутизаторами. ASBR Summary LSA отличается от Network Summary LSA тем, что распространяется информация не о сети, а о пограничном маршрутизаторе автономной системы.</p>

		<p><strong>Type 5 LSA — AS External LSA</strong> — объявление о состоянии внешних каналов автономной системы. Объявление распространяется пограничным маршрутизатором автономной системы в пределах всей автономной системы. Объявление описывает маршруты, внешние для автономной системы OSPF, или маршруты по умолчанию (default route), внешние для автономной системы OSPF.</p>

		<p><strong>Type 6 LSA — Multicast OSPF LSA</strong> — специализированный LSA, который используют мультикаст OSPF приложения (Not implemented by CISCO).</p>

		<p><strong>Type 7 LSA — AS External LSA for NSSA</strong> — объявления о состоянии внешних каналов автономной системы в NSSA зоне. Это объявление может передаваться только в NSSA зоне. На границе зоны пограничный маршрутизатор преобразует type 7 LSA в type 5 LSA.</p>

		<p><strong>Type 8 LSA — Link LSA</strong> — анонсирует link-local адрес и префикс(ы) маршрутизатора всем маршрутизаторам разделяющим канал (link). Отправляется только если на канале присутствует более чем один маршрутизатор. Распространяются только в пределах канала (link).</p>

		<p><strong>Type 9 LSA — Intra-Area-Prefix LSA</strong> ставит в соответствие: список префиксов IPv6 и маршрутизатор, указывая на Router LSA, список префиксов IPv6 и транзитную сеть, указывая на Network LSA. Распространяются только в пределах одной зоны.</p>

		<hr><h3>Типы зон</h3>

		<p>При разделении автономной системы на зоны маршрутизаторам, принадлежащим к одной зоне, не известна информация о детальной топологии других зон.</p>

		<p>Разделение на зоны позволяет:</p>

		<ul>
			<li>Снизить нагрузку на ЦП маршрутизаторов за счёт уменьшения количества перерасчётов по алгоритму OSPF</li>
			<li>Уменьшить размер таблиц маршрутизации</li>
			<li>Уменьшить количество пакетов обновлений состояния канала</li>
		</ul>

		<p>Каждой зоне присваивается идентификатор зоны (area ID). Идентификатор может быть указан в десятичном формате или в формате записи IP-адреса. Однако идентификаторы зон не являются IP-адресами и могут совпадать с любым назначенным IP-адресом.</p>

		<p>Существует несколько типов зон:</p>

		<p><strong>Магистральная зона (backbone area)</strong></p>

		<p>Магистральная зона (известная также как нулевая зона или зона 0.0.0.0) формирует ядро сети OSPF. Все остальные зоны соединены с ней, и межзональная маршрутизация происходит через маршрутизатор соединенный с магистральной зоной. Магистральная зона ответственна за распространение маршрутизирующей информации между немагистральными зонами. Магистральная зона должна быть смежной с другими зонами, но она не обязательно должна быть физически смежной; соединение с магистральной зоной может быть установлено и с помощью виртуальных каналов.</p>

		<p><strong>Стандартная зона (standard area)</strong></p>

		<p>Обычная зона, которая создается по умолчанию. Эта зона принимает обновления каналов, суммарные маршруты и внешние маршруты.</p>

		<p><strong>Тупиковая зона (stub area)</strong></p>

		<p>Тупиковая зона не принимает информацию о внешних маршрутах для автономной системы, но принимает маршруты из других зон. Если маршрутизаторам из тупиковой зоны необходимо передавать информацию за границу автономной системы, то они используют маршрут по умолчанию. В тупиковой зоне не может находиться ASBR.</p>

		<p><strong>Totally stubby area</strong></p>

		<p>Totally stubby area не принимает информацию о внешних маршрутах для автономной системы и маршруты из других зон. Если маршрутизаторам необходимо передавать информацию за пределы зоны, то они используют маршрут по умолчанию. Cisco-proprietary тип зоны.</p>

		<p><strong>Not-so-stubby area (NSSA)</strong></p>

		<p>Зона NSSA определяет дополнительный тип LSA — LSA type 7. В NSSA зоне может находиться ASBR.</p>

		<hr><h3>Формат OSPF-пакетов</h3>

		<p>OSPF-пакет инкапсулируется непосредственно в поле данных IP-пакета. Значение поля «протокол верхнего уровня» в заголовке IP-дейтаграммы для OSPF равно 89.</p>

		<p><strong>Заголовок пакета</strong></p>

		<center><img src="../../../images/protocol/ospf.png"></center>

		<p>Version — номер версии протокола OSPF, текущая версия OSPF для сетей IPv4 — 2;</p>
		<p>Type — тип OSPF-пакета;</p>
		<p>Packet length — длина пакета, включая заголовок;</p>
		<p>Router ID — идентификатор маршрутизатора, уникальное 32-битное число, идентифицирующее маршрутизатор в пределах автономной системы;</p>
		<p>Area ID — 32-битный идентификатор зоны;</p>
		<p>Checksum — поле контрольной суммы, подсчитывается для всего пакета, включая заголовок;</p>
		<p>Authentication type — тип используемой схемы аутентификации, возможные значения:</p>

		<ul>
			<li>0 — аутентификация не используется</li>
			<li>1 — аутентификация открытым текстом</li>
			<li>2 — MD5-аутентификация</li>
		</ul>

		<p>Authentication — поле данных аутентификации.</p>

		<p><strong>Hello-пакет</strong></p>

		<p>Hello-пакет предназначен для установления и поддержания отношений с соседями. Пакет периодически посылается на все интерфейсы маршрутизатора.</p>

		<center><img src="../../../images/protocol/ospf2.png"></center>

		<p>Network mask — сетевая маска интерфейса, через который отправляется hello-пакет;</p>
		<p>Hello interval — интервал задающий частоту рассылки приветственных сообщений для обнаружения соседей в автономной системе, для LAN значение по умолчанию равно 10 секундам;</p>
		<p>Options — 8-битное поле опций, описывает возможности маршрутизатора;</p>
		<p>Router priority — приоритет маршрутизатора, 8-битное число, символизирующее приоритет маршрутизатора при выборе DR (англ. Designated router) и BDR (англ. Backup designated router);</p>
		<p>Router dead interval — период времени, в течение которого маршрутизатор ожидает ответа соседей;</p>
		<p>Designated router (DR) — IP-адрес DR;</p>
		<p>Backup designated router (BDR) — IP-адрес BDR;</p>
		<p>Neighbor ID — идентификатор соседа. Список составляется из идентификаторов соседей, от которых маршрутизатор получил hello-пакеты в течение времени, заданного в поле router dead interval;</p>

		<p><strong>Database Description</strong></p>

		<p>Пакет Database Description описывает содержание базы данных состояния канала. Обмен пакетами производится при установлении состояния смежности.</p>

		<center><img src="../../../images/protocol/ospf3.png"></center>

		<p>Interface MTU — размер в байтах наибольшей IP дейтаграммы, которая может быть послана через данный интерфейс без фрагментации;</p>
		<p>I-бит — устанавливается для первого пакета в последовательности;</p>
		<p>M-бит — указывает наличие последующих дополнительных пакетов;</p>
		<p>MS-бит — устанавливается для ведущего, сбрасывается для ведомого;</p>
		<p>DD sequence number — в начальном пакете устанавливается на уникальное значение, при передаче каждого последующего пакета увеличивается на единицу, пока не будет передана вся база данных;</p>
		<p>LSA headers — массив заголовков базы данных состояния каналов.</p>

		<p><strong>Link State Request</strong></p>

		<p>Пакет Link State Request предназначен для запроса части базы данных соседнего маршрутизатора.</p>

		<center><img src="../../../images/protocol/ospf4.png"></center>

		<p>LS Type — тип объявления о состоянии канала;</p>
		<p>Link State ID — идентификатор домена маршрутизации;</p>
		<p>Advertising Router — идентификатор маршрутизатора, создавшего объявление о состоянии канала.</p>

		<p><strong>Link State Update</strong></p>

		<p>Пакет Link State Update предназначен для рассылки объявлений о состоянии канала. Пакет посылается по групповому адресу на один транзитный участок.</p>

		<center><img src="../../../images/protocol/ospf5.png"></center>

		<p>Number of LSA — количество объявлений в пакете.</p>

		<p><strong>Link State Acknowledgment</strong></p>

		<p>Подтверждает получение пакета Link State Update.</p>

		<center><img src="../../../images/protocol/ospf6.png"></center>

		<hr><h3>Версии протокола OSPF</h3>

		<p><strong>OSPF версия 2</strong></p>

		<p>поддерживает версию протокола IPv4</p>

		<p><strong>OSPF версия 3</strong></p>

		<p>поддерживает версию протокола IPv6</p>

		<hr><h3>Критика</h3>

		<p>Считается, что благодаря использованию алгоритма Дейкстры специфического критерия качества распределения входного потока информации, он абсолютно не защищает IP-сеть от перегрузок, что требует реализации дополнительных методов по снижению вероятности перегрузки. Например, предлагается использовать в критерии распределения остаточную пропускную способность канала.</p>

		<p>В то же время, к положительным качествам протокола можно отнести относительную простоту практической реализации алгоритма.</p>

	</div>

</div>


</body>
</html>